<div class="page">

  <div class="page-header">
    <h2>Account Book</h2>
    <p class="subtitle">Manage balances and track transactions</p>
  </div>

  <!-- Accounts -->
  <div class="accounts">
    <div class="account-card" *ngFor="let a of accounts">

      <div class="top">
        <div>
          <h3>{{ a.name }}</h3>
          <div class="balance">₹ {{ a.balance | number }}</div>
        </div>
      </div>

      <div class="buttons">
        <button mat-stroked-button color="primary" (click)="open(a, 'Credit')">
          + Credit
        </button>
        <button mat-stroked-button color="warn" (click)="open(a, 'Debit')">
          − Debit
        </button>
      </div>

      <button class="view-history" (click)="toggleHistory(a)">
        {{ selectedAccount?.id === a.id ? 'Hide History' : 'View History →' }}
      </button>
    </div>
  </div>

  <!-- History Section -->
  <div class="history-section" *ngIf="selectedAccount">

    <div class="history-header">
      <div>
        <h3>{{ selectedAccount.name }}</h3>
        <span>Transaction History</span>
      </div>

      <button mat-icon-button (click)="selectedAccount = null">
        ✕
      </button>
    </div>

    <div class="history-list">
      <div class="history-item" *ngFor="let t of selectedAccount.transactions">
        <div class="amount">
          <span [class.credit]="t.type === 'Credit'"
                [class.debit]="t.type === 'Debit'">
            {{ t.type }}
          </span>
          ₹{{ t.amount }}
        </div>

        <div class="note">{{ t.note || 'No note' }}</div>
        <div class="date">{{ t.date | date:'dd MMM yyyy, hh:mm a' }}</div>
      </div>

      <div class="empty" *ngIf="selectedAccount.transactions.length === 0">
        No transactions yet
      </div>
    </div>
  </div>

</div>
