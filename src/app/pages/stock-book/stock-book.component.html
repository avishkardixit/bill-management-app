<div class="stock-page">
  <h2>Stock Book</h2>

  <!-- STOCK CARDS -->
  <div class="stock-grid">
    <div class="stock-card" *ngFor="let s of stocks">
      <div class="card-header">
        <h3>{{ s.color }}</h3>
        <span class="badge">Coil</span>
      </div>

      <div class="kg">
        {{ s.availableKg }} kg
      </div>

      <div class="actions">
        <ng-container *ngIf="!s.editing; else editMode">
          <button class="btn-outline" (click)="s.editing = true">
            Edit
          </button>
        </ng-container>

        <ng-template #editMode>
          <input type="number" [(ngModel)]="s.availableKg" />
          <button class="btn-primary" (click)="save(s)">
            Save
          </button>
        </ng-template>
      </div>
    </div>
  </div>

  <!-- HISTORY TABLE -->
  <!-- HISTORY TABLE -->
<div class="history-section">
  <div class="history-header">
    <h3>Stock Usage History</h3>

    <select [(ngModel)]="selectedColor" (change)="applyFilter()">
      <option value="">All Colors</option>
      <option *ngFor="let s of stocks" [value]="s.color">
        {{ s.color }}
      </option>
    </select>
  </div>

  <table class="history-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Color</th>
        <th>Weight Used (kg)</th>
        <th>Bill ID</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let h of filteredHistory">
        <td>{{ h.date | date:'short' }}</td>
        <td>{{ h.color }}</td>
        <td>{{ h.weightUsed }}</td>
        <td>#{{ h.billId }}</td>
      </tr>

      <tr *ngIf="filteredHistory.length === 0">
        <td colspan="4" class="no-data">No history for this color</td>
      </tr>
    </tbody>
  </table>
</div>

</div>
